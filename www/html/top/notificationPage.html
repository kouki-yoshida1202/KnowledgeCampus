<ons-page id="chatPage">
  <ons-toolbar>
    <div class="left">
      <ons-back-button> </ons-back-button>
    </div>
    <div
      class="center"
      id="toolbar-title"
      style="display:flex;align-items: center;justify-content: center;"
    >
      通知
    </div>
  </ons-toolbar>
  <div class="content">
    <ons-list id="myNotificationList" style="background-image: none;">
    </ons-list>
  </div>
  <script>
    notificationSearch();
    function notificationSearch() {
      $("#myNotificationList").empty();
      var user = firebase.auth().currentUser;
      var myUserId = user.uid;
      console.log(myUserId);

      ncmb.Installation.equalTo("userId", myUserId)
        .fetch()
        .then(function(installation) {
          ncmb.Push.in("objectId", installation.pushes)
            .order("createDate", true)
            .limit(10)
            .fetchAll()
            .then(function(pushes) {
              for (var i = 0; i < pushes.length; i++) {
                console.log(pushes[i].message);
                var pushList =
                  `
                <ons-list-item>
                  <div
                    class="left"
                  >
                    <img
                      class="list-item__thumbnail"
                      src="img/knowledgeLogo.png"
                      style="width:45px;height:45px;border-radius: 50%;object-fit:cover;"
                    />
                  </div>
                  <div
                    class="center"
                    style="width:50%;"
                  >
                    <span
                      class="list-item__subtitle light-navy-font"
                      style="height:55px;overflow: hidden;"
                      >` +
                  pushes[i].message +
                  `</span
                    >
                  </div>
                  <div class="right">
                    <span class="list-item__subtitle light-navy-font">` +
                  jikanCulc(pushes[i].createDate) +
                  `</span>
                  </div>
                </ons-list-item>
                `;
                $("#myNotificationList").append(pushList);
              }
            })
            .catch(function(error) {
              console.log(error);
            });
        });
    }
  </script>
</ons-page>
